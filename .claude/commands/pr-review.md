---
name: PR Review
description: PRの変更に対して4つのレビューエージェントを並列実行し、結果を集約してプランを立て、必要に応じて修正を行う
category: Review
tags: [review, pr, quality, security, performance, test]
---

# PR Review Workflow

PRの変更に対して包括的なコードレビューを実行します。

## 実行手順

### Step 1: PRの変更内容を特定

まず、現在のブランチとmainブランチの差分を確認し、レビュー対象のファイルを特定してください。

```bash
git diff main...HEAD --name-only
```

### Step 2: 4つのレビューエージェントを並列実行

以下の4つのサブエージェントを**必ず並列で**（単一メッセージで複数のTask tool呼び出し）実行してください：

1. **code-quality-reviewer**: コード品質、可読性、ベストプラクティスのレビュー
2. **performance-analyzer**: パフォーマンス問題、N+1クエリ、最適化機会の分析
3. **security-reviewer**: セキュリティ脆弱性、入力検証、認証/認可の問題のレビュー
4. **test-coverage-reviewer**: テストカバレッジ、テスト品質、不足しているテストケースのレビュー

各エージェントには以下を伝えてください：
- レビュー対象のファイル一覧
- PRの目的（わかる場合）
- 特に注目すべき変更点

### Step 3: レビュー結果の集約

4つのエージェントからの結果を以下の形式で集約してください：

```markdown
## レビュー結果サマリー

### Critical（即座に対応が必要）
- [ ] 問題1
- [ ] 問題2

### Warning（対応推奨）
- [ ] 問題1
- [ ] 問題2

### Info（検討事項）
- [ ] 問題1
- [ ] 問題2

### Good（良い点）
- 良い点1
- 良い点2
```

### Step 4: 修正プランの作成

Critical または Warning の問題がある場合：

1. 各問題に対する修正方針を立てる
2. 依存関係を考慮して修正順序を決定
3. TodoWrite で修正タスクを作成

### Step 5: 修正の実行（ユーザー承認後）

修正が必要な場合、ユーザーに確認を取ってから：

1. 適切なサブエージェント（code-implementer, frontend-implementer など）に修正を委託
2. 各修正完了後、関連するレビュー項目をチェック
3. すべての修正完了後、再度レビューエージェントで確認（必要に応じて）

## 注意事項

- レビューエージェントは**並列実行**して効率化すること
- 修正は**ユーザー承認後**に実行すること
- 修正後は必ず**テストを実行**して回帰がないことを確認すること
